<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Minecraft</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/PointerLockControls.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
    </style>
</head>
<body>
    <script>
        // Scene Setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87CEEB); // Sky blue background
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 2, 5);
        
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Grass Ground
        const groundGeometry = new THREE.PlaneGeometry(50, 50);
        const groundMaterial = new THREE.MeshStandardMaterial({ color: 0x228B22, side: THREE.DoubleSide });
        const ground = new THREE.Mesh(groundGeometry, groundMaterial);
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = 0;
        scene.add(ground);

        // Sun Light
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(10, 20, 10);
        scene.add(light);

        // Ambient Light for soft lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        // Walls (Randomly placed obstacles)
        const walls = [];
        function createWall(x, z) {
            const wallGeometry = new THREE.BoxGeometry(3, 3, 3);
            const wallMaterial = new THREE.MeshStandardMaterial({ color: 0x8B0000 });
            const wall = new THREE.Mesh(wallGeometry, wallMaterial);
            wall.position.set(x, 1.5, z);
            scene.add(wall);
            walls.push(wall);
        }

        createWall(0, -10);
        createWall(10, 5);
        createWall(-10, -5);
        createWall(5, 10);
        createWall(-5, -10);

        // Pointer Lock Controls for FPP
        const controls = new THREE.PointerLockControls(camera, document.body);
        document.addEventListener("click", () => controls.lock());
        scene.add(controls.getObject());

        // Player Movement
        const movement = { forward: false, backward: false, left: false, right: false };
        document.addEventListener("keydown", (e) => {
            if (e.key === "w") movement.forward = true;
            if (e.key === "s") movement.backward = true;
            if (e.key === "a") movement.left = true;
            if (e.key === "d") movement.right = true;
        });
        document.addEventListener("keyup", (e) => {
            if (e.key === "w") movement.forward = false;
            if (e.key === "s") movement.backward = false;
            if (e.key === "a") movement.left = false;
            if (e.key === "d") movement.right = false;
        });

        // Player Velocity
        let velocity = new THREE.Vector3();
        const speed = 0.1;
        
        function checkCollision(newPosition) {
            for (let wall of walls) {
                const boxSize = 2;
                if (
                    Math.abs(newPosition.x - wall.position.x) < boxSize &&
                    Math.abs(newPosition.z - wall.position.z) < boxSize
                ) {
                    return true;
                }
            }
            return false;
        }

        // Game Loop
        function animate() {
            requestAnimationFrame(animate);
            
            let direction = new THREE.Vector3();
            camera.getWorldDirection(direction);
            direction.y = 0; // Keep movement horizontal
            direction.normalize();
            
            let moveStep = new THREE.Vector3();
            if (movement.forward) moveStep.add(direction.clone().multiplyScalar(speed));
            if (movement.backward) moveStep.add(direction.clone().multiplyScalar(-speed));
            if (movement.left) moveStep.add(new THREE.Vector3().crossVectors(direction, new THREE.Vector3(0, 1, 0)).multiplyScalar(-speed));
            if (movement.right) moveStep.add(new THREE.Vector3().crossVectors(direction, new THREE.Vector3(0, 1, 0)).multiplyScalar(speed));
            
            let newPosition = controls.getObject().position.clone().add(moveStep);
            if (!checkCollision(new THREE.Vector3(newPosition.x, controls.getObject().position.y, controls.getObject().position.z))) {
                controls.moveRight(moveStep.x);
            }
            if (!checkCollision(new THREE.Vector3(controls.getObject().position.x, controls.getObject().position.y, newPosition.z))) {
                controls.moveForward(-moveStep.z);
            }
            
            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
</html>

